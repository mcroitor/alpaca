# Essay Evaluation Tool

Автоматизированная система оценки студенческих работ с использованием языковых моделей через Ollama. Система позволяет оценивать эссе, задания по программированию и другие текстовые работы на основе предопределённых критериев.

## Описание

Этот инструмент использует большие языковые модели (LLM) для автоматической оценки студенческих работ. Система анализирует ответы студентов, сравнивает их с критериями оценивания и выставляет баллы по каждому критерию.

## Структура проекта

```text
samples/essay/
├── config.json              # Основная конфигурация
├── eval_essay.php           # Главный скрипт оценивания
├── readme.md               # Данная документация
├── mc/                     # Классы для работы с заданиями
│   └── essay/
│       ├── Assessor.php    # Класс для оценивания
│       └── Task.php        # Класс задания
├── templates/              # Шаблоны промптов
│   └── prompt.template     # Шаблон для LLM
└── data/                   # Данные заданий
```

## Требования

- **PHP 7.4+** с поддержкой JSON и cURL
- **Ollama сервер** запущенный локально или удалённо
- **Установленные модели** в Ollama (например, llama2, gemma, cogito)

## Установка и настройка

### 1. Установка Ollama

```bash
# Скачайте и установите Ollama с официального сайта
# https://ollama.ai

# Запустите Ollama сервер
ollama serve

# Загрузите необходимые модели
ollama pull llama2
ollama pull gemma:7b
```

### 2. Настройка конфигурации

Отредактируйте файл `config.json`:

```json
{
    "models": ["llama2", "gemma:7b"],
    "task_name": "Название задания",
    "task_definition_file": "data/essay2/task.md",
    "rubric_file": "data/essay2/rubric.md",
    "input_directory": "data/essay2/input",
    "output_directory": "data/essay2/output",
    "ollama_server": "http://127.0.0.1:11434"
}
```

### 3. Подготовка данных

1. **Создайте файл задания** (`task.md`) с описанием задания и критериями оценивания
2. **Добавьте студенческие работы** в папку `input/` с расширением `.essay`
3. **Убедитесь**, что папка `output/` существует для сохранения результатов

## Использование

### Запуск с конфигурацией по умолчанию

```bash
php eval_essay.php
```

### Запуск с параметрами командной строки

```bash
# Основные параметры
php eval_essay.php --config custom_config.json
php eval_essay.php --input ./my_essays --output ./results
php eval_essay.php --models "llama2,gemma:7b"

# Полный список параметров
php eval_essay.php --help
```

### Доступные параметры

| Параметр | Короткая форма | Описание |
|----------|---------------|----------|
| `--help` | `-h` | Показать справку |
| `--config FILE` | `-c FILE` | Путь к файлу конфигурации |
| `--input DIR` | `-i DIR` | Папка с входными файлами |
| `--output DIR` | `-o DIR` | Папка для результатов |
| `--rubric FILE` | `-r FILE` | Файл с критериями оценивания |
| `--taskdef FILE` | `-t FILE` | Файл с определением задания |
| `--models LIST` | `-m LIST` | Список моделей через запятую |

## Формат входных файлов

### Файл задания (task.md)

```markdown
# Название задания

## Task Definition
Описание задания для студентов...

## Solution sample
Пример правильного решения...

## Evaluation
Критерии оценивания в виде рубрики...
```

### Студенческие работы (.essay)

Простые текстовые файлы с ответами студентов.

## Примеры заданий

### Essay1 - Docker Compose

Задание на создание файла `docker-compose.yml` с оценкой по 18 критериям.

### Essay2 - Dockerfile

Задание на создание `Dockerfile` с детализированной рубрикой по уровням качества.

## Настройка шаблонов

Файл `templates/prompt.template` содержит шаблон промпта для языковой модели:

```plaintext
# Essay Task: {{task_name}}

Assess the Student Response based on the below rubric...

## Task Description
{{task_description}}

## Evaluation rubric  
{{rubric}}

## Student Response
{{student_response}}
```

Доступные переменные:

- `{{task_name}}` - название задания
- `{{task_description}}` - описание задания  
- `{{rubric}}` - критерии оценивания
- `{{student_response}}` - ответ студента
- `{{max_score}}` - максимальный балл

## Архитектура

### Основные классы

- **`\mc\essay\Task`** - представляет задание с критериями оценивания
- **`\mc\essay\Assessor`** - выполняет оценивание с помощью LLM

### Процесс оценивания

1. Загрузка конфигурации и параметров командной строки
2. Подключение к серверу Ollama и получение списка моделей
3. Загрузка определения задания и критериев оценивания
4. Чтение студенческих работ из входной папки
5. Для каждой модели и каждой работы:
   - Формирование промпта на основе шаблона
   - Отправка запроса к языковой модели
   - Сохранение результата в выходную папку

## Лучшие практики

### Создание заданий

- Используйте четкие и конкретные критерии оценивания
- Включайте примеры правильных решений
- Определяйте уровни качества для каждого критерия

### Выбор моделей

- Тестируйте разные модели для вашего типа заданий
- Более крупные модели обычно дают более точные оценки
- Используйте несколько моделей для сравнения результатов

### Валидация результатов

- Проверяйте результаты оценивания на выборке работ
- Сравнивайте с оценками преподавателей
- Корректируйте промпты и критерии при необходимости

## Устранение неисправностей

### Распространённые проблемы

**Ошибка подключения к Ollama:**

```bash
Error: Cannot connect to Ollama server at 'http://127.0.0.1:11434'
```

- Убедитесь, что Ollama сервер запущен
- Проверьте URL сервера в конфигурации

**Модель не найдена:**

```bash
Error: No valid models available
```

- Загрузите модели: `ollama pull model_name`
- Проверьте написание названий моделей

**Файлы не найдены:**

- Проверьте пути к файлам в конфигурации
- Убедитесь, что файлы заданий и студенческие работы существуют

## Расширение функциональности

Система легко расширяется для новых типов заданий:

1. Создайте новую папку в `data/`
2. Добавьте файл `task.md` с описанием задания
3. Создайте папки `input/` и `output/`
4. Обновите конфигурацию
5. При необходимости модифицируйте шаблон промпта

## Лицензия

Этот проект является частью Alpaca PHP Client и распространяется под той же лицензией.
